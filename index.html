<html>
  <script>
    let webpSupported = null;

    const checkWebp = (callback) => {
      console.log("webpSupported", webpSupported);

      if (webpSupported !== null) {
        return webpSupported;
      }

      const img = new Image();

      img.onload = () => {
        const result = img.width > 0 && img.height > 0;
        callback(result);
      };
      img.onerror = () => {
        callback(false);
      };

      img.src =
        "data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA";
    };

    checkWebp((isSupported) => {
      console.log("isSupported", isSupported);
      alert(isSupported ? "WebP is supported" : "WebP is not supported");
      webpSupported = isSupported;

      if (isSupported) {
        checkVariant(variant);
      }
    });
  </script>
</html>
